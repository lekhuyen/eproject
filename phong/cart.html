<!DOCTYPE html>
<html>
  <head>
    <title>Cart</title>
    <script>
      "use strict";
      
      !function() {
        var t = window.driftt = window.drift = window.driftt || [];
        if (!t.init) {
          if (t.invoked) return void (window.console && console.error && console.error("Drift snippet included twice."));
          t.invoked = !0, t.methods = [ "identify", "config", "track", "reset", "debug", "show", "ping", "page", "hide", "off", "on" ], 
          t.factory = function(e) {
            return function() {
              var n = Array.prototype.slice.call(arguments);
              return n.unshift(e), t.push(n), t;
            };
          }, t.methods.forEach(function(e) {
            t[e] = t.factory(e);
          }), t.load = function(t) {
            var e = 3e5, n = Math.ceil(new Date() / e) * e, o = document.createElement("script");
            o.type = "text/javascript", o.async = !0, o.crossorigin = "anonymous", o.src = "https://js.driftt.com/include/" + n + "/" + t + ".js";
            var i = document.getElementsByTagName("script")[0];
            i.parentNode.insertBefore(o, i);
          };
        }
      }();
      drift.SNIPPET_VERSION = '0.3.1';
      drift.load('skd536zbews8');
      </script>
    <link rel="stylesheet" href="cart.css">
    <script src="/baimoi/cart.js"></script>
    <!-- <script src="/baimoi/cart.js"></script> -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="/phong/doan.js"></script>

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
      <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
  </head>
  <body>
    <header>
      <nav
          class="navbar fixed-top navbar-expand-lg bg-body-tertiary bg-dark-subtle">
          <div class="container-fluid">
              <a class="navbar-brand" href="/index.html"><img
                      src="/picture/logo.png" width="40px" height="40px"></a>
              <button class="navbar-toggler" type="button"
                  data-bs-toggle="collapse" data-bs-target="#navbarScroll"
                  aria-controls="navbarScroll" aria-expanded="false"
                  aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarScroll">
                  <ul class="navbar-nav me-auto my-2 my-lg-0
                      navbar-nav-scroll" style="--bs-scroll-height:
                      100px;">
                      <li class="nav-item">
                          <a class="nav-link active" aria-current="page"
                              href="/index.html" data-i18n="home"
                              style="margin-left: 30px;">Home</a>
                      </li>
                      <li class="nav-item">
                          <a class="nav-link active" aria-current="page"
                              href="/baimoi/course1.html" data-i18n="home"
                              style="margin-left: 30px;">Course</a>
                      </li>
                      <li class="nav-item">
                          <a class="nav-link"
                              href="/Hau/aboutus/aboutus.html"
                              data-i18n="about"
                              style="margin-left: 30px;">About us</a>
                          <span id="usernameSpan"></span>
                      </li>

                      <li class="nav-item">
                          <a class="nav-link"
                              href="/Hau/Contact us/contact.html"
                              data-i18n="contact"
                              style="margin-left: 30px;">Contact</a>
                      </li>
                      <li class="nav-item">
                          <a href="/phong/dangnhap.html" class="nav-link"
                              id="loginLink"
                              style="text-decoration: none; color: rgb(30, 147, 201); margin-left: 30px; font-weight: 800;">Login</a>
                          <a href="#" onclick="logout(event)"
                              class="nav-link" id="logoutLink"
                              style="display: none; text-decoration: none; color: rgb(30, 147, 201); font-weight: 800;">Logout</a>
                      </li>
                      <li class="nav-item">
                          <p style="margin-left: 20px;" class="nav-link">
                              Username:<span id="username" style="color: rgb(0, 145, 255); font-weight: 600; cursor: pointer;" onclick="showUserOptions()"></span>
                              <img id="avatarImg" src
                                  style="width: 30px; height: 30px; margin-left: 10px; display: none;">
                          </p>
                          <div id="userOptions" class="user-options">
                              <div class="option"
                                  onclick="showChangePasswordModal()">Change Password</div>
                              <div class="option"
                                  onclick="showChangeNameModal()">Change Name</div>
                              <div class="option"
                                  onclick="document.getElementById('avatarInput').click()">Change Avatar</div>
                              <div id="fileInputContainer"
                                  style="display: none;">
                                  <input type="file" id="avatarInput"
                                      accept="image/*"
                                      onchange="changeAvatar(event)"
                                      style="display: none;">
                              </div>
                          </div>
                      </li>
                      <!-- Modal cho đổi mật khẩu -->

                      <li>
                          <div class="navbar-language"
                              style="margin-left:
                              50px;">
                              <select id="language-selector"
                                  onchange="changeLanguage()">
                                  <option value="en">English</option>
                                  <option value="vn">Tiếng Việt</option>
                                  <option value="hi">हिन्दी</option>
                              </select>
                          </div>
                      </li>
                      <li class="nav-item" style="margin-left: 50px;">
                          <a href="/phong/cart.html" class="nav-link"><ion-icon
                                  name="cart"
                                  style="width: 50px; height: 50px; color:
                                  blue;"></ion-icon>
                              <span id="cartItemCount"
                                  class="cart-item-count"
                                  style="position:
                                  absolute; color: rgb(11, 51, 251);">0</span></a>
                      </li>
                  </ul>
                  <form class="d-flex" role="search">
                      <input class="form-control me-2 w-50" type="search"
                          placeholder="Search" aria-label="Search">
                      <button class="btn btn-outline-success"
                          type="submit">Search</button>
                  </form>
              </div>
          </div>
      </nav>

  </header>
  <div class="main-1-img">
    <div class="main-1-img-1">
        <div class="main-1-img-1-title">
            <p>Cart</p>
            <div class="a-home">
                <a href="#">Home</a> / Cart
            </div>
        </div>
    </div>
</div>
    <div id="cart-content" class="shopping-cart">
      <div class="list">
        <h3><img src="/picture/logo.png" width="150px" height="150px"> <span class="city">List Cart Product</span></h3> 
      </div>

      <div class="column-labels">
        <label class="product-image">Image</label>
        <label class="product-details">Product</label>
        <label class="product-price">Price</label>
        <label class="product-quantity">Quantity</label>
        <label class="product-line-price">Total</label>
        <label class="product-removal">Remove</label>
      </div>

      <div class="cart-items">
        <!-- Các mục hàng sẽ được tạo động từ Local Storage -->
      </div>

      <div class="totals">
        <div class="totals-item">
          <label>Subtotal</label>
          <div class="totals-value" id="cart-subtotal">0.00</div>
        </div>
        <div class="totals-item">
          <label>Tax (5%)</label>
          <div class="totals-value" id="cart-tax">0.00</div>
        </div>
        <div class="totals-item">
          <label>Shipping</label>
          <div class="totals-value" id="cart-shipping">0.00</div>
        </div>
        <div class="totals-item totals-item-total">
          <label>Grand Total</label>
          <div class="totals-value" id="cart-total">0.00</div>
        </div>
      </div>

      <button class="checkout" onclick="checkout()">Checkout</button>
    </div>
    <div id="empty-cart" class="hinhanh" style="display: none;">
      <div class="texthinhanh">
      <img src="https://img.freepik.com/premium-vector/3d-shopping-cart-with-cloud-online-shopping-digital-marketing-ideas-basket-promotional-labels-white-background-shopping-bag-buy-sell-discount-3d-vector-icon-illustration_412828-974.jpg?w=900" style="border-radius: 10px;" width="30%">
      <h4>Shopping cart feels empty</h4>
      <p>Someone please buy something from my courses</p>
    </div>
    </div>
    <div class="sale">
      <div class="sale1">
        <img src="https://media3.scdn.vn/img4/2020/12_16/gJwXr6FFZKZCGKWaz4RB.png" width="150px" >
        <br>
        <span class="textto">Good Product</span> <br>
        <span>There Are Many <br> Courses Needed</span>
      </div>
      <div class="sale2">
        <img src="https://media3.scdn.vn/img4/2020/12_16/EfZWQVfV6nQzu2vMmnwC.png" width="150px" >
        <br>
        <span class="textto">Super Peace Of Mind</span> <br>
        <span>Free Returns and Exchanges within 48 hours</span>
      </div>
      <div class="sale3">
        <img src="https://media3.scdn.vn/img4/2020/12_16/j5C6IQz7gIXPgjFJxmRz.png" width="150px" >
        <br>
        <span class="textto">Super Safe</span> <br>
        <span>Don't Worry About <br> Being Scammed</span>
      </div>
      <div class="sale4">
        <img src="https://media3.scdn.vn/img4/2020/12_16/7AJFQGQ5qvS7gGOz8P7a.png"  width="150px" >
        <br>
        <span class="textto">Super savings</span> <br>
        <span>Reasonable price, affordable. There are always many promotions</span>
      </div>
    </div>
    <!-- <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script> -->
    <script>
    // Lấy giỏ hàng từ Local Storage
    function getCart() {
      let cart = localStorage.getItem('cart');
      return cart ? JSON.parse(cart) : [];
    }
    function checkout() {
      // Kiểm tra xem người dùng đã đăng nhập chưa
      var isLoggedIn = localStorage.getItem('isLoggedIn');
      if (isLoggedIn === 'true') {
        // Người dùng đã đăng nhập
        alert('Thanh Toán Thành Công');
        clearCart(); // Xoá giỏ hàng sau khi thanh toán thành công
      } else {
        // Người dùng chưa đăng nhập
        var cartItems = getCart();
        if (cartItems.length > 0) {
          alert('Bạn chưa đăng nhập!');
        } else {
          alert('Giỏ hàng của bạn đang trống!');
        }
      }
    }

    // Lấy giỏ hàng từ Local Storage
    function getCart() {
      var cart = localStorage.getItem('cart');
      return cart ? JSON.parse(cart) : [];
    }

    // Xoá giỏ hàng
    function clearCart() {
      localStorage.removeItem('cart');
      updateCart();
    }


    // Tính tổng giá trị giỏ hàng và cập nhật giao diện
    function updateCart() {
      const cartItems = getCart();
      const cartContainer = document.querySelector('.cart-items');
      cartContainer.innerHTML = '';

      let subtotal = 0;

      cartItems.forEach((cartItem, index) => {
        const { item, price, quantity, total, image } = cartItem;

        const productElement = document.createElement('div');
        productElement.classList.add('product');

        const productImageElement = document.createElement('div');
        productImageElement.classList.add('product-image');
        const productImage = document.createElement('img');
        productImage.src = image;
        productImageElement.appendChild(productImage);

        const productDetailsElement = document.createElement('div');
        productDetailsElement.classList.add('product-details');
        const productTitleElement = document.createElement('div');
        productTitleElement.classList.add('product-title');
        productTitleElement.textContent = item;
        const productQuantityElement = document.createElement('div');
        productQuantityElement.classList.add('product-quantity');
        productQuantityElement.textContent = quantity;

        productDetailsElement.appendChild(productTitleElement);
        productDetailsElement.appendChild(productQuantityElement);

        const productPriceElement = document.createElement('div');
        productPriceElement.classList.add('product-price');
        productPriceElement.textContent = price.toFixed(2);

        const productLinePriceElement = document.createElement('div');
        productLinePriceElement.classList.add('product-line-price');
        productLinePriceElement.textContent = total.toFixed(2);

        const productRemovalElement = document.createElement('div');
        productRemovalElement.classList.add('product-removal');
        const removeButton = document.createElement('button');
        removeButton.classList.add('remove-from-cart');
        const removeIcon = document.createElement('i');
        removeIcon.classList.add('fas', 'fa-trash-alt');
        removeButton.appendChild(removeIcon);
        productRemovalElement.appendChild(removeButton);
        removeButton.setAttribute('data-index', index);
        productRemovalElement.appendChild(removeButton);
        productElement.appendChild(productImageElement);     
        productElement.appendChild(productDetailsElement);     
        productElement.appendChild(productPriceElement);       
        productElement.appendChild(productQuantityElement);
        productElement.appendChild(productLinePriceElement);
        productElement.appendChild(productRemovalElement);
        cartContainer.appendChild(productElement);

        subtotal += total;
      });

      const cartSubtotalElement = document.getElementById('cart-subtotal');
      const cartTaxElement = document.getElementById('cart-tax');
      const cartTotalElement = document.getElementById('cart-total');

      const taxRate = 0.05;
      const shippingCost = 0.0;

      const tax = subtotal * taxRate;
      const total = subtotal + tax + shippingCost;

      cartSubtotalElement.textContent = subtotal.toFixed(2);
      cartTaxElement.textContent = tax.toFixed(2);
      cartTotalElement.textContent = total.toFixed(2);
       // Kiểm tra nếu đã đăng nhập và giỏ hàng trống
    }

    // Xóa mục hàng khỏi giỏ hàng
    function removeFromCart(event) {
      const button = event.target;
      const index = button.getAttribute('data-index');
      let cart = getCart();
      

      if (index >= 0 && index < cart.length) {
        cart.splice(index, 1);
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCart();
      }
      
    }
    

    // Lắng nghe sự kiện nhấp vào nút "Buy Now" và "Remove"
    document.addEventListener('click', function(event) {
      if (event.target.classList.contains('add-to-cart')) {
        const button = event.target;
        const item = button.getAttribute('product-title');
        const price = parseFloat(button.getAttribute('product-price'));
        const quantity = parseInt(button.getAttribute('product-quantity'));
        const image = button.getAttribute('product-image');
        
        let cart = getCart();

       
    
        // Kiểm tra xem sản phẩm đã tồn tại trong giỏ hàng chưa
        const existingItem = cart.find((cartItem) => cartItem.item === item);
        if (existingItem) {
          existingItem.quantity += quantity;
          existingItem.total = existingItem.price * existingItem.quantity;
        } else {
          cart.push({ item, price, quantity, total: price * quantity, image });
        }

        localStorage.setItem('cart', JSON.stringify(cart));
        updateCart();
      } else if (event.target.classList.contains('remove-from-cart')) {
        removeFromCart(event);
      }
      
    });
    
    

    // Cập nhật giỏ hàng khi trang được tải
    updateCart();
  </script>
  <!-- login -->
  <script>
    // Kiểm tra xem người dùng đã đăng nhập hay chưa
    function isLoggedIn() {
                  return localStorage.getItem('isLoggedIn') === 'true';
                }
            
                // Cập nhật trạng thái đăng nhập
                function updateLoginStatus() {
                  var loginLink = document.getElementById('loginLink');
                  var logoutLink = document.getElementById('logoutLink');
                  var username = document.getElementById('username');
            
                  if (isLoggedIn()) {
                    username.textContent = localStorage.getItem('username'); // Hiển thị tên người dùng
                    loginLink.style.display = 'none'; // Ẩn liên kết "Login"
                    logoutLink.style.display = 'inline-block'; // Hiển thị liên kết "Logout"
                  } else {
                    username.textContent = ''; // Xóa tên người dùng
                    loginLink.style.display = 'inline-block'; // Hiển thị liên kết "Login"
                    logoutLink.style.display = 'none'; // Ẩn liên kết "Logout"
                  }
                }
            
                // Xử lý khi trang index được tải
                document.addEventListener('DOMContentLoaded', function() {
                  updateLoginStatus(); // Cập nhật trạng thái đăng nhập
                });
            
                // Xử lý khi người dùng logout
                function logout(event) {
                  event.preventDefault();
                  localStorage.setItem('isLoggedIn', 'false');
                  updateLoginStatus(); // Cập nhật trạng thái đăng nhập
                }
    // Kiểm tra xem có hàng trong giỏ hàng hay không
    function hasItemsInCart() {
      var cartItems = getCart();
      return cartItems.length > 0;
    }
  
    // Cập nhật hiển thị giỏ hàng
    function updateCartDisplay() {
      var cartContent = document.getElementById('cart-content');
      var emptyCart = document.getElementById('empty-cart');
  
      if (hasItemsInCart()) {
        cartContent.style.display = 'block';
        emptyCart.style.display = 'none';
      } else {
        cartContent.style.display = 'none';
        emptyCart.style.display = 'block';
      }
    }

    // Các hàm khác để lấy giỏ hàng và cập nhật giỏ hàng đã được đề cập ở các câu trước
  
    // Cập nhật hiển thị giỏ hàng khi trang được tải
    document.addEventListener('DOMContentLoaded', function() {
      updateCartDisplay();
    });
  </script>
  <script src="/phong/doan.js"></script>
  </body>
  <div id="changePasswordModal" class="modal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Đổi mật khẩu</h5>
          <button type="button" class="close" data-dismiss="modal" onclick="closeChangePasswordModal()">&times;</button>
        </div>
        <div class="modal-body">
          <form onsubmit="changePassword(event)">
            <div class="form-group">
              <label for="newPassword">Mật khẩu mới:</label>
              <input type="password" class="form-control" id="newPassword" required>
            </div>
            <button type="submit" class="btn btn-primary">Đổi mật khẩu</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Đổi tên Modal -->
  <div id="changeNameModal" class="modal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Đổi tên</h5>
          <button type="button" class="close" data-dismiss="modal" onclick="closeChangePasswordModal()">&times;</button>
        </div>
        <div class="modal-body">
          <form onsubmit="changeName(event)">
            <div class="form-group">
              <label for="newName">Tên mới:</label>
              <input type="text" class="form-control" id="newName" required>
            </div>
            <button type="submit" class="btn btn-primary">Đổi tên</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <footer>
    <iframe src="/phong/footer.html" frameborder="0" scrolling="no" class="iframe3"></iframe>
  </footer>
</html>